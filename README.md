Colby Wise
Matrix Factorization

# Movie Recommendation Engine


## Project Description:

This project is an example movie recommendation engine using the MovieLens 20 Million dataset. The data-set contains 20000263 ratings across 27278 movies as generated by 138493 users between January 09, 1995 to March 31, 2015. All selected users have rated at least 20 movies.

Recommendations are done via matrix factorization and completion by decomposing the original user:movie:rating matrix into two low rank factorizations. Specifically,
we decompose the user:movie:rating matrix [R] which is a U x M into a user matrix [U] that is U x r and movie matrix [M] that is r x M. (r) represents a learned low rank approximation that can be thought of abstractly as feature representations of [R]. We explore various impacts of [r] on model performance. 

The model is trained (i.e. [r] "learned") via an implementation of Gradient Descent where we minimize the Mean Squared Error (MSE) of the predicted rating vs true rating plus regularization of the frobenius norm of U or V. Model evaluation is done during training by randomly subsample 5% of the test data and evaluting MSE. Final model evaluation is done using Mean Reciprocal Rank (MRR) - https://en.wikipedia.org/wiki/Mean_reciprocal_rank.  


*The model was trained on a Google Cloud VM with 8 CPU|52Gb RAM. Average run time per epoch was ~7 minutes, with total training time of 10 epochs ~70-75 minutes.*


## Data Description:

The data-set contains 20,000,263 ratings across 26,744 unique movies generated by 138,493 users between January 09, 1995 to March 31, 2015. All selected users have rated at least 20 movies. A link to the data is below. Note that for this project I focus solely on the matrix factorization algorithm as described above, but the data contains additional csv files that can be used for broader pre and post exploratory analysis. 

Link: http://files.grouplens.org/datasets/movielens/ml-20m.zip

### Train | Test Split:

##### - Processing -
50% of data, ~ 10,000,000 ratings for each of train/test where for each user we evenly split their ratings into train/test to ensure user data balance. While not implemented here, other splits can be considered and explored with trade offs. For example, randomly split may bias training data towards select users while excluding others. 


Format: CSV -> ratings.csv
Ratings: 20,000,263 (rows)
User: 138,493
Movies: 26,744
Timestamp: date/time when rated

## Project Files
1. Readme.MD
2. MovieLens_Matrix_Factorization.ipynb
3. Write_up.pdf - Written report detailing empirical results and procedures
4. src - main code base directory
	1. best_model.py - contains main class to implement matrix factorization and shows specs of best model   
	2. processing.py - Data cleaning and formating functions
	3. model_evaluation.py - Model evaluation driver functions
	4. train_test_split.py - example of how to split data
	5. csv_split.sh - example shell script to split data into train/test
	
5. supplemental - Visualizations and supplementary documents




